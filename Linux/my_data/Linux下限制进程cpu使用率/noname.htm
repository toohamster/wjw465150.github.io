<!-- saved from url=http://www.oschina.net/discuss/thread/2329 -->
<script>
window.onerror = new Function("return(false);")
</script><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML minmax_bound="true"><HEAD minmax_bound="true"><TITLE minmax_bound="true">Linux下限制进程cpu使用率 - 开源中国社区</title><LINK media=screen 
href="osc-common.css" type=text/css rel=stylesheet 
minmax_bound="true"><LINK media=screen href="osc-list.css" type=text/css 
rel=stylesheet minmax_bound="true"><LINK href="osc-bbs.css_v=20090803" 
type=text/css rel=stylesheet minmax_bound="true"><LINK media=screen 
href="thickbox.css" type=text/css rel=stylesheet minmax_bound="true">
<SCRIPT src="jquery.js" type=text/javascript 
minmax_bound="true"></SCRIPT>

<SCRIPT src="jquery.form.js" type=text/javascript 
minmax_bound="true"></SCRIPT>

<SCRIPT src="common.js" type=text/javascript minmax_bound="true"></SCRIPT>

<SCRIPT src="thickbox.js" type=text/javascript 
minmax_bound="true"></SCRIPT>
</HEAD>

<BODY minmax_bound="true">

<DIV id="OSC_screen" minmax_bound="true">

<TABLE cellSpacing=0 cellPadding=0 width="100%" minmax_bound="true">

<TBODY minmax_bound="true">

<TR minmax_bound="true">

<TD class=ThreadList id=MainContent 
style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 10px; MARGIN: 0px; PADDING-RIGHT: 10px" 
vAlign="top" minmax_bound="true">

<DIV class="Thread" minmax_bound="true"><!--StartFragment-->
<H3 class="type_1" minmax_bound="true">Linux下限制进程cpu使用率 </H3>
<DIV class="outline" minmax_bound="true"><SPAN class="user" minmax_bound="true"><A 
href="http://www.oschina.net/user/17" minmax_bound="true">范堡</A></SPAN> <SPAN class="time" 
minmax_bound="true">发表于 2009-08-14 11:00</SPAN> <SPAN class="stat" 
minmax_bound="true">0回/107阅 </SPAN><SPAN class="project" 
minmax_bound="true">，对应项目：<A href="http://www.oschina.net/p/redhat_linux" target="project" 
minmax_bound="true">红帽企业 Linux</A></SPAN> </DIV>
<DIV class="content" minmax_bound="true">
<DIV id="RelatedThreads" minmax_bound="true"><STRONG 
minmax_bound="true">相关话题</STRONG> 
<UL minmax_bound="true">
<LI minmax_bound="true"><A title=Sun发布MySQL&nbsp;5.4&nbsp;响应速度提升90%&nbsp;？？真的假的？ 
href="http://www.oschina.net/discuss/thread/372" 
minmax_bound="true">Sun发布MySQL&nbsp;5.4&nbsp;响应速度提升90%&nbsp;？？...</A> 
<LI minmax_bound="true"><A title=弹指一挥40年&nbsp;服务器操作系统进化简史 href="http://www.oschina.net/discuss/thread/150" 
minmax_bound="true">弹指一挥40年&nbsp;服务器操作系统进化简史</A> </LI></UL></DIV>
<P minmax_bound="true">很用 
Linux时可能大家经常发现莫名其妙就变的非常慢，这时多半是后台进程使用的cpu和内存太多了。如何限制每个进程的cpu使用资源呢？</P>
<P minmax_bound="true">可以使用cpulimit限制每个进程的cpu使用率，使用率用百分百来表示。</P>
<P minmax_bound="true"><STRONG minmax_bound="true">安装cpulimit</STRONG></P>
<H3 minmax_bound="true">使用源码安装</H3><PRE class="prettyprint" minmax_bound="true"><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cd &nbsp;/tmp</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># wget &nbsp;'http://downloads.sourceforge.net/cpulimit/cpulimit-1.1.tar.gz'</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># tar &nbsp;cpulimit-1.1.tar.gz</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cd cpulimit-1.1</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># make</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cp cpulimit &nbsp;/usr/local/sbin/</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># rm -rf cpulimit*</SPAN></SPAN></PRE>
<H3 minmax_bound="true">Debian / Ubuntu 用户</H3>
<P minmax_bound="true">使用apt-get更方便的安装</P><PRE class="prettyprint" minmax_bound="true"><SPAN class="pln" minmax_bound="true">$ sudo apt</SPAN><SPAN class="pun" minmax_bound="true"><SPAN style="COLOR: #666600" minmax_bound="true">-</SPAN></SPAN><SPAN class="pln" minmax_bound="true">get &nbsp;update<BR minmax_bound="true">$ sudo apt</SPAN><SPAN class="pun" minmax_bound="true"><SPAN style="COLOR: #666600" minmax_bound="true">-</SPAN></SPAN><SPAN class="pln" minmax_bound="true">get install cpulimit</SPAN></PRE>
<P minmax_bound="true"><STRONG minmax_bound="true">如何使用cpulimit?</STRONG></P>
<P minmax_bound="true">限制firefox使用30% cpu利用率</P><PRE class="prettyprint" minmax_bound="true"><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cpulimit -e firefox -l 30</SPAN></SPAN></PRE>
<P minmax_bound="true">限制进程号1313的程序使用30% cpu利用率</P><PRE class="prettyprint" minmax_bound="true"><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cpulimit -p 1313 -l 30</SPAN></SPAN></PRE>
<P minmax_bound="true">根据进程名找出pid的方法</P><PRE class="prettyprint" minmax_bound="true"><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># ps aux | less</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># ps aux | grep firefox</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># pgrep -u vivek php-cgi</SPAN></SPAN><SPAN class="pln" minmax_bound="true"><BR minmax_bound="true"></SPAN><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># pgrep lighttpd</SPAN></SPAN></PRE>
<P minmax_bound="true">可以使用绝对路径限制进程的cpu利用率</P><PRE class="prettyprint" minmax_bound="true"><SPAN class="com" minmax_bound="true"><SPAN style="COLOR: #880000" minmax_bound="true"># cpulimit -P /opt/firefox/firebox -l 30</SPAN></SPAN></PRE>
<P minmax_bound="true"><STRONG minmax_bound="true">单核cpu和多核cpu</STRONG></P>
<P minmax_bound="true">单核cpu的使用率范围为0%-100%,四核cpu的使用率范围为0%-400%.</P>
<P minmax_bound="true"><STRONG minmax_bound="true">相关工具</STRONG></P>
<P minmax_bound="true">nice:以指定的优先级运行程序</P>
<P minmax_bound="true">renice:&nbsp; 调整以运行进程的优先级</P>
<DIV class="clear" minmax_bound="true"></DIV></DIV><!--EndFragment--></DIV>
</TD>
</TR>
</TBODY>
</TABLE>
</DIV>
<P>&nbsp;</P>
<P>&nbsp;</P>
</BODY>
</HTML>