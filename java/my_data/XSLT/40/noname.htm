<!-- saved from url=http://www.w3school.com.cn/xpath/xpath_examples.asp -->
<script>
window.onerror = new Function("return(false);")
</script><!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML xmlns="http://www.w3.org/1999/xhtml"><HEAD><META content="IE=7.0000" 
http-equiv="X-UA-Compatible">
<TITLE>XPath 实例</TITLE><LINK rel=stylesheet type=text/css href="c3.css"></HEAD>

<BODY class=xml>

<DIV id=wrapper>

<DIV id=maincontent><!--StartFragment--><H1>XPath 实例</H1>
<DIV id=tpn>
<UL class=prenext>
<LI class=pre><A href="http://www.w3school.com.cn/xpath/xpath_operators.asp">Previous Page</A> </LI>
<LI class=next><A href="http://www.w3school.com.cn/xpath/xpath_summary.asp">Next Page</A> </LI></UL></DIV>
<DIV id=intro>
<P><STRONG>在本节，让我们通过实例来学习一些基础的 XPath 语法。</STRONG></P></DIV>
<DIV>
<H2>XML实例文档</H2>
<P>我们将在下面的例子中使用这个 XML 文档：</P>
<H3>"books.xml" :</H3><PRE>&lt;?xml version="1.0" encoding="ISO-8859-1"?&gt;

&lt;bookstore&gt;

&lt;book category="COOKING"&gt;
  &lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;
  &lt;author&gt;Giada De Laurentiis&lt;/author&gt;
  &lt;year&gt;2005&lt;/year&gt;
  &lt;price&gt;30.00&lt;/price&gt;
&lt;/book&gt;

&lt;book category="CHILDREN"&gt;
  &lt;title lang="en"&gt;Harry Potter&lt;/title&gt;
  &lt;author&gt;J K. Rowling&lt;/author&gt;
  &lt;year&gt;2005&lt;/year&gt;
  &lt;price&gt;29.99&lt;/price&gt;
&lt;/book&gt;

&lt;book category="WEB"&gt;
  &lt;title lang="en"&gt;XQuery Kick Start&lt;/title&gt;
  &lt;author&gt;James McGovern&lt;/author&gt;
  &lt;author&gt;Per Bothner&lt;/author&gt;
  &lt;author&gt;Kurt Cagle&lt;/author&gt;
  &lt;author&gt;James Linn&lt;/author&gt;
  &lt;author&gt;Vaidyanathan Nagarajan&lt;/author&gt;
  &lt;year&gt;2003&lt;/year&gt;
  &lt;price&gt;49.99&lt;/price&gt;
&lt;/book&gt;

&lt;book category="WEB"&gt;
  &lt;title lang="en"&gt;Learning XML&lt;/title&gt;
  &lt;author&gt;Erik T. Ray&lt;/author&gt;
  &lt;year&gt;2003&lt;/year&gt;
  &lt;price&gt;39.95&lt;/price&gt;
&lt;/book&gt;

&lt;/bookstore&gt;</PRE>
<P><A href="http://www.w3school.com.cn/xpath/books.xml">在您的浏览器中查看此 "books.xml" 文件</A>。</P></DIV>
<DIV>
<H2>节点选取</H2>
<P>我们将使用微软的 XML DOM 对象来载入 XML 文档，并使用 selectNodes() 函数从 XML 文档选取节点：</P><PRE>set xmlDoc=CreateObject("Microsoft.XMLDOM")
xmlDoc.async="false"
xmlDoc.load("books.xml")

xmlDoc.selectNodes(路径表达式)</PRE></DIV>
<DIV>
<H2>选取所有的 book 节点</H2>
<P>下面的这个例子选取了 bookstore 元素下所有的 book 节点：</P><PRE>xmlDoc.selectNodes("/bookstore/book")</PRE>
<P>假如您正在使用 IE 5 或更高的版本，可以<A 
href="http://www.w3school.com.cn/tiy/t.asp?f=xpth_select_cdnodes">亲自试一试</A>。</P></DIV>
<DIV>
<H2>选取第一个 book 节点</H2>
<P>下面的例子仅选取 bookstore 元素下第一个 book 节点：</P><PRE>xmlDoc.selectNodes("/bookstore/book[0]")</PRE>
<P>假如您正在使用 IE 5或更高的版本，可以<A 
href="http://www.w3school.com.cn/tiy/t.asp?f=xpth_select_cdnodes_first">亲自试一试</A>。</P>
<P class=note><SPAN>注释：</SPAN>IE 5 和 6 会把 [0] 作为第一个节点来执行，但是根据 W3C 的标准，应该使用 [1] 
！！</P>
<P class=note><SPAN>注释：</SPAN>这个问题在 IE 6 SP2 中被纠正了！</P></DIV>
<DIV>
<H2>选取 price</H2>
<P>下面的例子从所有的 price 节点选取文本：</P><PRE>xmlDoc.selectNodes("/bookstore/book/price/text()")</PRE>
<P>假如您正在使用 IE 5 或更高的版本，可以<A 
href="http://www.w3school.com.cn/tiy/t.asp?f=xpth_select_pricenodes_text">亲自试一试</A>。</P></DIV>
<DIV>
<H2>选取价格高于 35 的 price 价格</H2>
<P>下面的例子会选取所有价格高于 35 的 price 节点：</P><PRE>xmlDoc.selectNodes("/bookstore/book[price&gt;35]/price")</PRE>
<P>假如您正在使用 IE 5 或更高的版本，可以<A 
href="http://www.w3school.com.cn/tiy/t.asp?f=xpth_select_pricenodes_35">亲自试一试</A>。</P></DIV>
<DIV>
<H2>选取价格高于 35 的 title 节点</H2>
<P>下面的例子会选取所有价格高于 35 的 title 节点：</P><PRE>xmlDoc.selectNodes("/bookstore/book[price&gt;35]/title")</PRE>
<P>假如您正在使用 IE 5 或更高的版本，可以<A 
href="http://www.w3school.com.cn/tiy/t.asp?f=xpth_select_pricenodes_high">亲自试一试</A>。</P></DIV>
<DIV id=bpn>
<UL class=prenext>
<LI class=pre><A href="http://www.w3school.com.cn/xpath/xpath_operators.asp">Previous Page</A> </LI>
<LI class=next><A href="http://www.w3school.com.cn/xpath/xpath_summary.asp">Next Page</A> </LI></UL></DIV><!--EndFragment--></DIV>
</DIV>
</BODY>
</HTML>