<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>java7 invokedynamic命令深入研究</title>
  </head>
  <body>
    <h1 class="postTitle" style="FONT-SIZE: 15px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: rgb(153,153,153) 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: bold; COLOR: rgb(0,0,0); PADDING-BOTTOM: 10px; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 0px; PADDING-LEFT: 5px; CLEAR: both; MARGIN: 0px; BORDER-LEFT: rgb(31,166,230) 5px solid; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.5em; PADDING-RIGHT: 100px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial"><a
        id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/sheeva/p/6344388.html" style="TEXT-DECORATION: none; COLOR: rgb(28,119,145); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px">java7
        invokedynamic命令深入研究</a></h1>
    <div class="clear" style="FONT-SIZE: 12px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 0px; PADDING-LEFT: 0px; CLEAR: both; MARGIN: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial"></div>
    <div class="postBody" style="FONT-SIZE: 12px; FONT-FAMILY: Verdana, Arial, Helvetica, sans-serif; WHITE-SPACE: normal; WORD-SPACING: 0px; BORDER-BOTTOM: rgb(0,0,0) 1px solid; TEXT-TRANSFORM: none; FONT-WEIGHT: 400; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; FONT-STYLE: normal; TEXT-ALIGN: left; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 0px; ORPHANS: 2; WIDOWS: 2; LETTER-SPACING: normal; LINE-HEIGHT: 1.8; PADDING-RIGHT: 2px; BACKGROUND-COLOR: rgb(255,255,255); TEXT-INDENT: 0px; font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial">
      <div id="cnblogs_post_body" class="blogpost-body" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 20px; PADDING-RIGHT: 0px">
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">在看java虚拟机字节码执行引擎的时候，里面提到了java虚拟机里调用方法的字节码指令有5种：</p>
        <ol style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 40px; MARGIN: 0px; PADDING-RIGHT: 0px">
          <li style="LIST-STYLE-TYPE: none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
 >
            <ol style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 40px; MARGIN: 0px; PADDING-RIGHT: 0px" 
 >
              <li style="LIST-STYLE-TYPE: decimal; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
   >invokestatic　　//调用静态方法 
              <li style="LIST-STYLE-TYPE: decimal; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
   >invokespecial　　//调用私有方法、实例构造器方法、父类方法 
              <li style="LIST-STYLE-TYPE: decimal; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
   >invokevirtual　　//调用实例方法 
              <li style="LIST-STYLE-TYPE: decimal; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
   >invokeinterface　　//调用接口方法，会在运行时再确定一个实现 此接口的对象 
              <li style="LIST-STYLE-TYPE: decimal; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px 0px 1em; PADDING-RIGHT: 0px" 
   ><strong style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px" 
   ><span
                               
    style="COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(255,255,255)" 
   >invokedynamic
                    　　</span></strong>//先在运行时动态解析出调用点限定符所引用的方法，然后再执行该方法，在此之前的4条调用指令，分派逻辑是固化在java虚拟机内部的，而invokedynamic指令的
                分派逻辑是由用户所设定的引导方法决定的。</li>
            </ol>
          </li>
        </ol>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">前4种很容易理解，但是第5种笔者本人从这段描述上无法理解这个invokedynamic到底是什么东
          西，于是决定从实践入手来剖析一下。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">invokedynamic本身是字节码命令，我们想直接调用这个命令只能手写java字节码，这个难度太
          大了。。有没有替换方案呢，答案是有的。</p>
        <h1 style="FONT-SIZE: 28px; FONT-WEIGHT: bold; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px 0px; LINE-HEIGHT: 1.5; PADDING-RIGHT: 0px"><strong style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px">ASM
            简介</strong></h1>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">官方的定义：ASM是一个java字节码操作和分析框架。可以用来编辑classes文件和直接动态生成
          class文件，一切都是直接基于二进制形式的。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">我来解释下：我们都知道，一个.java文件编译后会生成.class文件，.java文件中记录代码的形
          式是java源代码，而.class文件中记录代码的形式是java字节码，这两者本质上是以不同的形式存储相同的内容，两者也可以相关转换（编译和反编译）。而asm本身是一个java库，所以说编写asm代码的时候本质是在写
          java源代码，但是asm代码的最终目的并不是为了运行，而是为了生成字节码。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">举个例子：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">我现在有一个Test.java类：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">package</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> common;

</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Test {
    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> say(){
        System.out.println(</span>"Hi"<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
    }
}
 </span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">这个类编译后生成Test.class，Test.class文件里存储的实际上就是一个byte数组，但
          是我们可以用javap -verbose命令翻译为字节码命令查看（忽略常量池等无关信息，只截取say()方法的CODE码）：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> say();
   flags: ACC_PUBLIC
   Code:
     stack</span>=2, locals=1, args_size=1
        0: <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">getstatic    </span> #15                 <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Field java/lang/System.out:Ljava/io/PrintStream;</span>
        3: <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">ldc          </span> #21                 <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> String Hi</span>
        5: <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">invokevirtual</span> #23                 <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
        8: <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">return</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"><br
 style  ="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px"></span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">我标红的部分就是从字节码翻译过来的字节码命令，字节码和字节码命令是一一对应的，如
          invokevirtual命令在源文件中就是一个字节 0xb6，对应关系可以查表：http://www.cnblogs.com/sheeva/p/6279096.html</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">看到这里我们会发现，这里的invokevirtual命令就是java调用方法的5种字节码中的第3种，
          如果我们能够修改这里的invokevirtual改成invokedynamic我们就能搞清楚invokedynamic到底是做什么的了，但是javap命令只能以命令的形式查看字节码却不能修改，这时候就轮到asm登场了。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">下载
          asm5.2：http://download.forge.ow2.org/asm/asm-5.2-bin.zip</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">解压后在lib里找到asm-all-5.2.jar放到Test.class的目录下，执行：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">java -classpath "./*"
          org.objectweb.asm.util.ASMifier Test.class，</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">运行结果如图：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px"><IMG style="MAX-WIDTH:
            660px; BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: 0px; PADDING-RIGHT: 0px" alt="" src="777853-20170123155019487-2104869408.png" ></p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">生成了一个java类的源码，里面有一个dump()方法，这个方法返回值是byte[]，这个
          byte[]的内容就是Test.class的字节码，也就是说如果把方法的返回值保存到一个文件，那么这个文件和Test.class文件是完全一样的。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">为了验证这个结论，我把这个方法粘贴出来，自己写一个类加载器来加载方法返回的字节码然后调用say()方
          法：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">package</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> invokedynamic;

</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> org.objectweb.asm.AnnotationVisitor;
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> org.objectweb.asm.ClassWriter;
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> org.objectweb.asm.FieldVisitor;
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> org.objectweb.asm.MethodVisitor;
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> org.objectweb.asm.Opcodes;

</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span> Hello <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">implements</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Opcodes {
    
    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span> main(String[] args) <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">throws</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Exception {
        </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">byte</span>[] codes=<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">dump();
        Class</span>&lt;?&gt; clazz=<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span> MyClassLoader().defineClass("common.Test"<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">, codes);
        clazz.getMethod(</span>"say", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>).invoke(clazz.newInstance(), <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Object[]{});
    }

    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">byte</span>[] dump() <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">throws</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Exception {

        ClassWriter cw </span>= <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span> ClassWriter(0<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
        FieldVisitor fv;
        MethodVisitor mv;
        AnnotationVisitor av0;

        cw.visit(V1_7, ACC_PUBLIC </span>+ ACC_SUPER, "common/Test", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, "java/lang/Object", <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);

        {
            mv </span>= cw.visitMethod(ACC_PUBLIC, "&lt;init&gt;", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitCode();
            mv.visitVarInsn(ALOAD, </span>0<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitMethodInsn(INVOKESPECIAL, </span>"java/lang/Object", "&lt;init&gt;", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">false</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitInsn(RETURN);
            mv.visitMaxs(</span>1, 1<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitEnd();
        }
        {
            mv </span>= cw.visitMethod(ACC_PUBLIC, "say", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitCode();
            mv.visitFieldInsn(GETSTATIC, </span>"java/lang/System", "out", "Ljava/io/PrintStream;"<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitLdcInsn(</span>"Hi"<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitMethodInsn(INVOKEVIRTUAL, </span>"java/io/PrintStream", "println", "(Ljava/lang/String;)V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">false</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitInsn(RETURN);
            mv.visitMaxs(</span>2, 1<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitEnd();
        }
        cw.visitEnd();

        </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">return</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> cw.toByteArray();
    }
    
    
    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">private</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span> MyClassLoader <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">extends</span> ClassLoader <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">implements</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Opcodes {
        </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> Class&lt;?&gt; defineClass(String name, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">byte</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">[] b){
            </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">return</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">super</span>.defineClass(name, b, 0<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">, b.length);
        }

    }
}</span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">运行成功：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px"><IMG style="MAX-WIDTH:
            660px; BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: 0px; PADDING-RIGHT: 0px" alt="" src="777853-20170123155826737-1256528503.png" ></p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">现在我们确定了，这个dump()方法确实能够生成Test.class的字节码，现在来看一下
          dump()方法里的内容：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'">    <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">byte</span>[] dump() <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">throws</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Exception {

        ClassWriter cw </span>= <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span> ClassWriter(0<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
        FieldVisitor fv;
        MethodVisitor mv;
        AnnotationVisitor av0;

        cw.visit(V1_7, ACC_PUBLIC </span>+ ACC_SUPER, "common/Test", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, "java/lang/Object", <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);

        {
            mv </span>= cw.visitMethod(ACC_PUBLIC, "&lt;init&gt;", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitCode();
            mv.visitVarInsn(ALOAD, </span>0<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitMethodInsn(INVOKESPECIAL, </span>"java/lang/Object", "&lt;init&gt;", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">false</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitInsn(RETURN);
            mv.visitMaxs(</span>1, 1<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitEnd();
        }
        {
            mv </span>= cw.visitMethod(ACC_PUBLIC, "say", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitCode();
            <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">mv.visitFieldInsn(GETSTATIC, </span></span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">"java/lang/System", "out", "Ljava/io/PrintStream;");
            mv.visitLdcInsn("Hi");
            mv.visitMethodInsn(INVOKEVIRTUAL, "java/io/PrintStream", "println", "(Ljava/lang/String;)V", false</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitInsn(RETURN);</span>
            mv.visitMaxs(</span>2, 1<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitEnd();
        }
        cw.visitEnd();

        </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">return</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> cw.toByteArray();
    }</span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">如果熟悉字节码的话，应该已经看出来了，dump()这个方法所在的类实现了Opcodes接
          口，Opcodes接口里定义了几乎全部的java字节码命令，我们之前说的5个invoke命令也在内：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px"><IMG style="MAX-WIDTH:
            660px; BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: 0px; PADDING-RIGHT: 0px" alt="" src="777853-20170123160327925-2001964475.png" ></p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">然后看一下dump()方法里我标红的4句，和之前的javap命令打出来的Test.class字节码命
          令对照看：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">mv.visitFieldInsn(GETSTATIC, "java/lang/System", "out", "Ljava/io/PrintStream;");
mv.visitLdcInsn("Hi");
mv.visitMethodInsn(INVOKEVIRTUAL, "java/io/PrintStream", "println", "(Ljava/lang/String;)V", false);
mv.visitInsn(RETURN);</span></pre>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">&nbsp;</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> say();
   flags: ACC_PUBLIC
   Code:
     stack</span>=2, locals=1, args_size=1
        <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">0: getstatic     #15 </span>                <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Field java/lang/System.out:Ljava/io/PrintStream;</span>
        <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">3: ldc           #21</span>                 <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> String Hi</span>
        <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">5: invokevirtual #23</span>                 <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Method java/io/PrintStream.println:(Ljava/lang/String;)V</span>
        <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(255,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">8: return</span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">不需要解释了吧。。</p>
        <h1 style="FONT-SIZE: 28px; FONT-WEIGHT: bold; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px 0px; LINE-HEIGHT: 1.5; PADDING-RIGHT: 0px">用asm调用
          invokedynamic指令</h1>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">现在我们来把原来say方法里的通过invokevirtual输出Hi的代码去掉，改成通过
          invokedynamic输出hello。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">在dump()方法所在的类Hello类的包里加一个类Bootstrap:</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">package</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> invokedynamic;

</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">import</span> java.lang.invoke.*<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">;

</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> Bootstrap {

    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">private</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> hello() {
        System.out.println(</span>"Hello!"<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
    }

    </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">public</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">static</span> CallSite bootstrap(MethodHandles.Lookup caller, String name, MethodType type) <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">throws</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> NoSuchMethodException, IllegalAccessException {
        MethodHandles.Lookup lookup </span>=<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> MethodHandles.lookup();
        Class thisClass </span>=<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> lookup.lookupClass();
        MethodHandle mh </span>= lookup.findStatic(thisClass, "hello", MethodType.methodType(<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">void</span>.<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">));
        </span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">return</span> <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'"> ConstantCallSite(mh.asType(type));
    }
}</span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">Hello类把say()方法里原来通过invokevirtual调用
          System.out.println()方法的那几行去掉，换成动态调用：</p>
        <div class="cnblogs_code" style="'OVERFLOW: auto; FONT-SIZE: 12px !important; BORDER-TOP: rgb(204,204,204) 1px solid; FONT-FAMILY: "Courier New" !important; BORDER-RIGHT: rgb(204,204,204) 1px solid; BORDER-BOTTOM: rgb(204,204,204) 1px solid; COLOR: rgb(0,0,0); PADDING-BOTTOM: 5px; PADDING-TOP: 5px; PADDING-LEFT: 5px; MARGIN: 5px 0px; BORDER-LEFT: rgb(204,204,204) 1px solid; PADDING-RIGHT: 5px; BACKGROUND-COLOR: rgb(245,245,245)'">
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
          <pre style="'WORD-WRAP: break-word; FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; WHITE-SPACE: pre-wrap; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; PADDING-RIGHT: 0px'"><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">        {
            mv </span>= cw.visitMethod(ACC_PUBLIC, "say", "()V", <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span>, <span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">null</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            mv.visitCode();
            
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            mv.visitFieldInsn(GETSTATIC, "java/lang/System", "out", "Ljava/io/PrintStream;");
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            mv.visitLdcInsn("Hi");
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            mv.visitMethodInsn(INVOKEVIRTUAL, "java/io/PrintStream", "println", "(Ljava/lang/String;)V", false);
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            mv.visitInsn(RETURN);
</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">//</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,128,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            mv.visitMaxs(2, 1);</span>
<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">            
            MethodType mt </span>= MethodType.methodType(CallSite.<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span>, MethodHandles.Lookup.<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span>, String.<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">,
                    MethodType.</span><span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">class</span><span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            Handle bootstrap </span>= <span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,255); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">new</span> Handle(Opcodes.H_INVOKESTATIC, "invokedynamic/Bootstrap", "bootstrap"<span
 style                ="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">,
                    mt.toMethodDescriptorString());
            mv.visitInvokeDynamicInsn(</span>"dynamicInvoke", "()V"<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">, bootstrap);
            mv.visitInsn(RETURN);
            mv.visitMaxs(</span>0, 1<span style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; COLOR: rgb(0,0,0); PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 0px'">);
            
            
            mv.visitEnd();
        }</span></pre>
          <div class="cnblogs_code_toolbar" style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 5px 0px 0px; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)"><span
              class="cnblogs_code_copy" style="'FONT-SIZE: 12px !important; FONT-FAMILY: "Courier New" !important; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; LINE-HEIGHT: 1.5 !important; PADDING-RIGHT: 5px'"><a
                title="复制代码" ><IMG
                  style="MAX-WIDTH: 660px; BORDER-TOP: medium none; BORDER-RIGHT: medium none; BORDER-BOTTOM: medium none; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: medium none; PADDING-RIGHT: 0px; BACKGROUND-COLOR: rgb(245,245,245)" alt=复制代码 src="https://common.cnblogs.com/images/copycode.gif" ></a></span></div>
        </div>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">再次运行，这次输出变了：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px"><IMG style="MAX-WIDTH:
            660px; BORDER-TOP: 0px; BORDER-RIGHT: 0px; BORDER-BOTTOM: 0px; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 0px; BORDER-LEFT: 0px; PADDING-RIGHT: 0px" alt="" src="777853-20170123161747269-950181406.png" ></p>
        <h1 style="FONT-SIZE: 28px; FONT-WEIGHT: bold; PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px 0px; LINE-HEIGHT: 1.5; PADDING-RIGHT: 0px">结论</h1>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">现在我们结合我们得到的代码，再重新理解一下invokedynamic的定义：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">先在运行时动态解析出调用点限定符所引用的方法，　　//即通过bootstrap方法动态解析出
          hello方法</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">然后再执行该方法，　　//即执行hello方法</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">而invokedynamic指令的分派逻辑是由用户所设定的引导方法决定的。　　//这里的引导方法，即
          我们定义的bootstrap方法，这里我们的逻辑是直接分派了hello方法，但是我们也可以写一些逻辑，比如根据调用时候的参数类型来动态决定调用哪个方法</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">&nbsp;</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">现在我们已经自己实践了invokedynamic命令的使用，但是我相信很多人还是不明白这个命令的意义
          所在，这要从语言的静态类型和动态类型说起：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">静态类型就是每个变量在初始化的时候就要声明唯一的类型并且不能改变。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">动态类型就是说变量没有固定类型，变量的类型取决于它里面元素的类型。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">java语言是静态类型的。有人可能会提到泛型，java的泛型是擦除式的，也就是说虽然在编写java源
          码时看起来好像不能确定变量类型，但是在java编译为字节码的过程中，每一个变量都是有确定的类型的。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">所以从java语言的角度，之前的4条方法调用指令是完全够用的，但是要知道，jvm不只是跨平台的，还是
          跨语言的，当有人在jvm上试图开发动态类型语言的时候，问题就来了：</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">jvm大多数指令都是类型无关的，但是在方法调用的时候，却不是这样，每个方法调用在编译阶段就必须指明方
          法参数和返回值类型，但是动态类型语言的方法参数，直到运行时刻才能知道类型啊，因此jdk就做了这样一个“补丁”：用invokedynamic调用方法的时候，会转到bootstrap方法，在这个方法里可以动态获取参数类型，然
          后根据参数类型分派合适的方法作为CallSite(动态调用点)，最后真实调用的就是CallSize里的方法。如此便能在jvm上实现动态类型语言的方法调用了。</p>
        <p style="PADDING-BOTTOM: 0px; PADDING-TOP: 0px; PADDING-LEFT: 0px; MARGIN: 10px auto; PADDING-RIGHT: 0px; TEXT-INDENT: 0px">&nbsp;</p>
      </div>
    </div>
  </body>
</html>
